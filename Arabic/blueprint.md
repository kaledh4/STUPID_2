# المخطط التفصيلي: NEON SPLASH (حرب مائية 4 ضد 4 بتوليد تلقائي)

## 1. المفهوم الأساسي
**النوع:** ساحة تصويب 4 ضد 4 بتوليد تلقائي (Procedural Arena Shooter).
**الجماليات:** Vaporwave / حفلة مسبح نيون.
**الميكانيكية الرئيسية:** أطلق النار على الأعداء لزيادة **البلل (Wetness)**. عند وصول البلل إلى 100%، **يتجمدون**. لا يوجد موت.
**المرئيات:** إضاءة LED نيون عالية التباين + جماليات مياه. ألوان تعتمد على الـ Seed.

## 2. الحلقة (The Loop)
`الوبي (التصويت على Seed)` -> `توليد الخريطة` -> `مباراة الفريق (أول من يصل لـ 50 تجميد)` -> `شاشة الفوز`

## 3. ميكانيكيات اللعب

### أ. نظام البلل (بديل الصحة)
*   **العداد:** 0% (جاف) إلى 100% (مبلل بالكامل).
*   **تلقي الضربة:** شعاع الماء الفوري (Hitscan) يضيف +15% بلل لكل ثانية من الاتصال المستمر.
*   **التجفيف:**
    *   سلبي: -5% لكل ثانية عند عدم التعرض للضرب لمدة 3 ثوانٍ.
    *   محطة المناشف (في القاعدة): تعيد العداد فوراً لـ 0%.
*   **حالة التجمد (100%):**
    *   يتحول نموذج اللاعب إلى تمثال جليدي (أو شبكة زرقاء ساطعة).
    *   لا يمكنه الحركة أو إطلاق النار لمدة **4 ثوانٍ**.
    *   يحتسب "نقطة" للفريق العدو.
    *   يمكن للزملاء إطلاق "هواء دافئ" (إطلاق ثانوي) لفك التجميد بشكل أسرع.

### ب. ميكانيكيات التصويب (حل "اللا لاغ" No Lag)
*   **السلاح:** مسدس ماء عالي الضغط.
*   **التقنية:** **شعاع مرئي من جانب العميل + Raycast من جانب السيرفر.**
    *   *بصرياً:* شبكة أسطوانية (Cylinder mesh) مع قوام مائي متحرك يربط السلاح بنقطة التصويب فوراً.
    *   *منطقياً:* يقوم Mirror بعمل Raycast. إذا أصاب عدواً، يتم استدعاء `CmdHitEnemy()`.
    *   *الشعور:* فوري، سريع الاستجابة، يشبه شعور "Ghostbusters proton pack". لا توجد مقذوفات بطيئة.

### ج. نظام الخريطة التلقائي
الخريطة عبارة عن "مسار" خطي مكون من **10 كتل (Chunks)**.
*   **الهيكل:** `[قاعدة فريق أ] - [كتلة 1] - [كتلة 2] ... [كتلة 8] - [قاعدة فريق ب]`
*   **نماذج الكتل (10x10م):**
    *   *النهر الكسول:* مسار منحني مع غطاء مائي.
    *   *الكابانا:* مناطق رأسية، قفز على الأسطح.
    *   *الزحليقة:* منحدر زلق يزيد السرعة.
    *   *المنطقة العميقة:* منطقة مفتوحة وخطرة.
*   **وضع التماثل (Symmetry Mode):** لضمان العدالة التنافسية، يقوم الـ seed بعكس الكتل. `كتلة 1` هي نفس الـ prefab لـ `كتلة 8`.

### د. نظام الألوان المعتمد على الـ Seed
كل مباراة لها لوحة ألوان مولدة بناءً على `MapSeed`.
*   **الخوارزمية:**
    *   `اللون الأساسي` (النيون) = HSV(Seed % 360, 100, 100).
    *   `اللون الثانوي` (الماء) = المكمل للون الأساسي.
    *   `لون الضباب` = اللون الثانوي بـ تشبع أقل.
*   **النتيجة:** تنوع بصري لا نهائي. "ذهبي وبنفسجي"، "سايبر بانك وردي وأزرق"، "أخضر سام وبرتقالي".

---

## 4. البنية التقنية (Mirror)

### إعداد اللاعب
*   `NetworkTransform`: مزامنة الموقع/الدوران.
*   `PlayerStats (SyncVar)`: `currentWetness` (عشري float). التحديث يربط واجهة المستخدم ولمعان الخامات (Material Glossiness).
*   `WeaponController`: يتعامل مع الـ Raycasting ومؤثرات الشعاع.

### شعاع "المقذوف الوهمي"
لا تقم بتوليد 1000 جزيء ماء.
1.  **عند الإطلاق:** تفعيل LineRenderer أو CylinderMesh.
2.  **القوام (Texture):** تحريك قوام ضوضاء (Noise Texture) عبر الـ UVs لمحاكاة تدفق الماء.
3.  **الاصطدام:** توليد جزيئات رذاذ (Splash Particles) محلية عند نقطة اصطدام الـ Raycast.

### التوليد التلقائي
*   **جانب السيرفر (Server-Side):**
    *   يأخذ `int seed`.
    *   Random.InitState(seed).
    *   يتم إنشاء كتل الـ Prefabs في خط.
    *   مزامنة `seed` لجميع العملاء (Clients) عبر `NetworkRoomManager`.
*   **جانب العميل (Client-Side):**
    *   يستلم `seed`.
    *   يطبق خوارزمية الألوان على متغيرات الـ Shader العالمية (`Shader.SetGlobalColor`).

---

## 5. متطلبات الأصول (Assets)

### نماذج ثلاثية الأبعاد (Synty / Low Poly)
*   **الشخصيات:** 4 تنويعات (غواص، منقذ، سباح، عوامة بطة).
*   **الأسلحة:** مسدس (Pistol)، سوبر سوكر (Super Soaker)، قناص (ضغط عالي).
*   **البيئة:** بلاط مسبح، أشجار نخيل، أنابيب نيون، كراسي بلاستيكية.

### الصوتيات
*   **المؤثرات (SFX):** رشة ماء عالية النبرة، طرطشة ثقيلة، صوت "تكسر" (تجمد)، صوت "مجفف شعر" (فك تجميد).
*   **الموسيقى:** موسيقى Synthwave / Vaporwave حماسية (Loop).

---

## 6. خارطة طريق لمدة 6 أشهر (مطور فردي)

### الشهر 1: الأنظمة الأساسية (اللعبة المصغرة)
*   **أسبوع 1-2:** إعداد Mirror، تحكم اللاعب، مزامنة "البلل".
*   **أسبوع 3-4:** السلاح. Shader الشعاع المرئي. كشف اصطدام Raycast. حالة التجمد.
*   **النتيجة:** صندوق رمادي (Graybox) حيث يمكن للاعبين تجميد بعضهما البعض.

### الشهر 2: المولد (التقنية)
*   **أسبوع 1-2:** بناء 4 نماذج كتل (Prefabs). كتابة `MapGenerator.cs`.
*   **أسبوع 3-4:** تنفيذ سكربت "ألوان الـ Seed". دمج واجهة المستخدم لإظهار الـ Seed.
*   **النتيجة:** مباريات قابلة للعب على خرائط عشوائية بألوان جنونية.

### الشهر 3: الفن والأجواء (المظهر)
*   **أسبوع 1-4:** استيراد أصول Synty. إنشاء الـ Shader الرئيسي لـ "مسبح النيون". دمج تصميم الصوت.
*   **النتيجة:** اللعبة تبدو مميزة وجاهزة للعرض على Steam.

### الشهر 4: حلقة اللعبة وواجهة المستخدم
*   **أسبوع 1-4:** القائمة الرئيسية، اللوبي، لوحة النتائج، المؤقت، شاشة الفوز. محطات المناشف.

### الشهر 5: توسيع المحتوى
*   **أسبوع 1-4:** إنشاء 6 أنواع كتل إضافية (المجموع 10). إضافة نوعين سلاح إضافي. نظام فتح المكافآت (Unlockables).

### الشهر 6: التحسين والإطلاق
*   **أسبوع 1-3:** اختبار بيتا مغلق. موازنة اللعبة. إصلاح الأخطاء.
*   **أسبوع 4:** **الإطلاق.**
